---
title: How to Build a Static Website Pipeline on AWS
updated: 2018-10-28 10:00s
---

This first post shows how to build a blog with a static website generator and how to use AWS tools like CodePipeline, S3, and CloudFront to implement a continuous delivery pipeline.

Jekyll is a popular static generator with a reasonable amount of themes available. For this example we are going to use the theme The Plain, but the procedure should be similar to other Jekyll themes as well. 

#### Setup the Jekyll's Theme

First of all, we fork the Jekyll's theme "The Plain" on GitHub. Then, we configure it by editing the "\_config.yml" file.

The first step was to fork the theme project on Github, configure it and commit the modifications to your Git repository.

1. Fork the repository https://github.com/heiswayi/the-plain.git
2. Edit the "\_config.yml" file
3. Create a new blog post by creating a file inside the "\_posts" directory
4. Test it locally
5. Commit and push to the remote Git repository

```bash
git clone https://your_repo_url
cd repo_name
gem bundle install
jekyll serve
```

#### Infrastructure Components

Now that you have a good idea of how it works, it is time to build the AWS infrastructure to host it. Here is the bill of materials for this project.

| Product       | Usage           |
| ------------- |:-------------:|
| Jekyll     | Generate the static content files |
| AWS S3     | Host the static content generated by Jekyll |
| AWS CloudFront      | Provide a content distribution network for our website |
| AWS CodePipeline | Provide a pipeline engine to perform continuous delivery |
| AWS CodeBuild | Build the static website with Jekyll and copy it to the hosting S3 bucket |
| AWS CloudFormation | Creates the infrastructure as code on AWS |

#### AWS Infrastructure Requirements

SSL Certificate

#### Infrastructure Components

To keep everything as code, I created a CloudFormation template to generate the whole infrastructure on AWS.

Here you can find the link for the CloudFormation templates.

| Parameter       | Description           |
| ------------- |:-------------:|
| Jekyll     | Generate the static content files |
| AWS S3     | Host the static content generated by Jekyll |
| AWS CloudFront      | Provide a content distribution network for our website |
| AWS CodePipeline | Provide a pipeline engine to perform continuous delivery |
| AWS CodeBuild | Build the static website with Jekyll and copy it to the hosting S3 bucket |
| AWS CloudFormation | Creates the infrastructure as code on AWS |

**NOTE:** The CloudFront distribution takes some time to create. While the CloudFormation creates the stack, take a coffee and relax.


#### Continuous Delivery Pipeline

Our Continuous Delivery Pipeline will be responsible to update our Blog when a blog post is created, edited or removed from the Git repository.

Source Code => Generate the static website files => Copy the static website files to the S3 bucket => Invalidate objects from CloudFront cache

| Step       | Usage           |
| ------------- |:-------------:|
| Source Code | When code is committed and pushed to the Master branch of our Git repository it triggers the AWS CodePipeline to download the source code and store it in a S3 bucket used by the pipeline. |
| Generate the static website files | AWS Code Build is started to run the "jekyll build" command and generate the static content |
| Copy the static website files to the S3 bucket | After the static content is generated, then the AWS Code Build copies the files to the S3 bucket where our site is hosted |
| Invalidate objects from CloudFront cache | As last step, the AWS Code Build calls the CloudFront API to invalidate the objects from cache. This steps is necessary to make sure users get the last version when they access the Blog page |

#### Pricing

This whole infrastructure can be create virtually for free.
