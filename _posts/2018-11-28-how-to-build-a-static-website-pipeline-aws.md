---
title: How to Build a Static Website Pipeline on AWS
updated: 2018-10-28 10:00s
---

This first post shows how to build a Blog with a static website generator and how to use AWS tools like CodePipeline, CodeBuild, S3, and CloudFront to host the website and implement a continuous delivery pipeline.

Jekyll is a popular static generator with a reasonable amount of themes available. As example for this post, we are going to use the theme The Plain, but the procedure should be similar to other Jekyll themes.

#### Setup the Jekyll's Theme

Follow these steps to perform the initial setup.

1. Fork the repository https://github.com/heiswayi/the-plain.git
2. Clone the forked repository to your machine "git clone https://your_repo_url"
2. Edit the \_config.yml file
3. Create a new blog post by creating a file inside the \_posts directory
4. Install the ruby gems required by Jekyll by running the command "gem bundle install"
4. Test it locally running the command "jekyll serve" inside the site directory
5. Commit and push the modifications to the remote Git repository

#### AWS Infrastructure Requirements

SSL Certificate - to host your Blog website with HTTPS support, make sure to create a new certificate on the AWS Certificate Manager service.

#### Infrastructure Components

Now that you have a good idea of how Jekyll works, it is time to build the AWS infrastructure to host the Blog website. Here is the list of services and software that we are going to use.

| Product       | Usage           |
| ------------- |:-------------:|
| Jekyll     | Generate the static content files |
| AWS S3     | Host the static content generated by Jekyll |
| AWS CloudFront      | Provide a content distribution network for our website |
| AWS CodePipeline | Provide a pipeline engine to perform continuous delivery |
| AWS CodeBuild | Build the static website with Jekyll and copy it to the hosting S3 bucket |
| AWS CloudFormation | Creates the infrastructure as code on AWS |

To keep everything as code, I created a CloudFormation template to generate the required infrastructure on AWS.

Here you can find the link for the CloudFormation templates.

**NOTE:** The CloudFront distribution takes some time to setup. While the CloudFormation is creating the stack, take a coffee and relax.

#### Continuous Delivery Pipeline

The Continuous Delivery Pipeline is in charge of updating our Blog website whenever a blog post is created, edited or removed from the Git repository.

Source Code => Generate the static website files => Copy the static website files to the S3 bucket => Invalidate objects from CloudFront cache

| Step       | Usage           |
| ------------- |:-------------:|
| Source Code | When code is committed and pushed to the Master branch of our Git repository it triggers the AWS CodePipeline to download the source code and store it in a S3 bucket used by the pipeline. |
| Generate the static website files | AWS Code Build is started to run the "jekyll build" command and generate the static content |
| Copy the static website files to the S3 bucket | After the static content is generated, then the AWS Code Build copies the files to the S3 bucket where our site is hosted |
| Invalidate objects from CloudFront cache | As last step, the AWS Code Build calls the CloudFront API to invalidate the objects from cache. This steps is necessary to make sure users get the last version when they access the Blog page |

#### Pricing

If you have an AWS free tier account, then the cost of this infrastructure on AWS will be virtually free. Take a look on the AWS free tier limits by visiting https://aws.amazon.com/free/
